#!/usr/bin/env python3
"""
Location mapping for Japanese prefectures and cities
Maps prefecture and city codes to their Japanese names
"""

# Prefecture code to name mapping
PREFECTURE_MAP = {
    '01': '北海道',
    '02': '青森県',
    '03': '岩手県',
    '04': '宮城県',
    '05': '秋田県',
    '06': '山形県',
    '07': '福島県',
    '08': '茨城県',
    '09': '栃木県',
    '10': '群馬県',
    '11': '埼玉県',
    '12': '千葉県',
    '13': '東京都',
    '14': '神奈川県',
    '15': '新潟県',
    '16': '富山県',
    '17': '石川県',
    '18': '福井県',
    '19': '山梨県',
    '20': '長野県',
    '21': '岐阜県',
    '22': '静岡県',
    '23': '愛知県',
    '24': '三重県',
    '25': '滋賀県',
    '26': '京都府',
    '27': '大阪府',
    '28': '兵庫県',
    '29': '奈良県',
    '30': '和歌山県',
    '31': '鳥取県',
    '32': '島根県',
    '33': '岡山県',
    '34': '広島県',
    '35': '山口県',
    '36': '徳島県',
    '37': '香川県',
    '38': '愛媛県',
    '39': '高知県',
    '40': '福岡県',
    '41': '佐賀県',
    '42': '長崎県',
    '43': '熊本県',
    '44': '大分県',
    '45': '宮崎県',
    '46': '鹿児島県',
    '47': '沖縄県',
}

# City code to name mapping (partial - focusing on major cities)
# Format: 'prefecture_code': {'city_code': 'city_name'}
CITY_MAP = {
    '12': {  # 千葉県
        '12100': '千葉市',
        '12101': '千葉市中央区',
        '12102': '千葉市花見川区',
        '12103': '千葉市稲毛区',
        '12104': '千葉市若葉区',
        '12105': '千葉市緑区',
        '12106': '千葉市美浜区',
        '12202': '銚子市',
        '12203': '市川市',
        '12204': '船橋市',
        '12205': '館山市',
        '12206': '木更津市',
        '12207': '松戸市',
        '12208': '野田市',
        '12209': '茂原市',
        '12210': '成田市',
        '12211': '佐倉市',
        '12212': '東金市',
        '12213': '旭市',
        '12214': '習志野市',
        '12215': '柏市',
        '12216': '勝浦市',
        '12217': '市原市',
        '12218': '松戸市',
        '12219': '八千代市',
        '12220': '流山市',
        '12221': '鴨川市',
        '12222': '鎌ケ谷市',
        '12223': '君津市',
        '12224': '富津市',
        '12225': '浦安市',
        '12226': '四街道市',
        '12227': '袖ケ浦市',
        '12228': '八街市',
        '12229': '印西市',
        '12230': '白井市',
        '12231': '富里市',
        '12232': '南房総市',
        '12233': '匝瑳市',
        '12234': '香取市',
        '12235': '山武市',
        '12236': 'いすみ市',
        '12237': '大網白里市',
    },
    '13': {  # 東京都
        '13101': '千代田区',
        '13102': '中央区',
        '13103': '港区',
        '13104': '新宿区',
        '13105': '文京区',
        '13106': '台東区',
        '13107': '墨田区',
        '13108': '江東区',
        '13109': '品川区',
        '13110': '目黒区',
        '13111': '大田区',
        '13112': '世田谷区',
        '13113': '渋谷区',
        '13114': '中野区',
        '13115': '杉並区',
        '13116': '豊島区',
        '13117': '北区',
        '13118': '荒川区',
        '13119': '板橋区',
        '13120': '練馬区',
        '13121': '足立区',
        '13122': '葛飾区',
        '13123': '江戸川区',
        '13201': '八王子市',
        '13202': '立川市',
        '13203': '武蔵野市',
        '13204': '三鷹市',
        '13205': '青梅市',
        '13206': '府中市',
        '13207': '昭島市',
        '13208': '調布市',
        '13209': '町田市',
        '13210': '小金井市',
        '13211': '小平市',
        '13212': '日野市',
        '13213': '東村山市',
        '13214': '国分寺市',
        '13215': '国立市',
        '13218': '福生市',
        '13219': '狛江市',
        '13220': '東大和市',
        '13221': '清瀬市',
        '13222': '東久留米市',
        '13223': '武蔵村山市',
        '13224': '多摩市',
        '13225': '稲城市',
        '13227': '羽村市',
        '13228': 'あきる野市',
        '13229': '西東京市',
    },
    '11': {  # 埼玉県
        '11100': 'さいたま市',
        '11101': 'さいたま市西区',
        '11102': 'さいたま市北区',
        '11103': 'さいたま市大宮区',
        '11104': 'さいたま市見沼区',
        '11105': 'さいたま市中央区',
        '11106': 'さいたま市桜区',
        '11107': 'さいたま市浦和区',
        '11108': 'さいたま市南区',
        '11109': 'さいたま市緑区',
        '11110': 'さいたま市岩槻区',
        '11201': '川越市',
        '11202': '熊谷市',
        '11203': '川口市',
        '11206': '行田市',
        '11207': '秩父市',
        '11208': '所沢市',
        '11209': '飯能市',
        '11210': '加須市',
        '11211': '本庄市',
        '11212': '東松山市',
        '11214': '春日部市',
        '11215': '狭山市',
        '11216': '羽生市',
        '11217': '鴻巣市',
        '11218': '深谷市',
        '11219': '上尾市',
        '11221': '草加市',
        '11222': '越谷市',
        '11223': '蕨市',
        '11224': '戸田市',
        '11225': '入間市',
        '11227': '朝霞市',
        '11228': '志木市',
        '11229': '和光市',
        '11230': '新座市',
        '11231': '桶川市',
        '11232': '久喜市',
        '11233': '北本市',
        '11234': '八潮市',
        '11235': '富士見市',
        '11237': '三郷市',
        '11238': '蓮田市',
        '11239': '坂戸市',
        '11240': '幸手市',
        '11241': '鶴ヶ島市',
        '11242': '日高市',
        '11243': '吉川市',
        '11245': 'ふじみ野市',
        '11246': '白岡市',
    },
    '14': {  # 神奈川県
        '14100': '横浜市',
        '14101': '横浜市鶴見区',
        '14102': '横浜市神奈川区',
        '14103': '横浜市西区',
        '14104': '横浜市中区',
        '14105': '横浜市南区',
        '14106': '横浜市保土ケ谷区',
        '14107': '横浜市磯子区',
        '14108': '横浜市金沢区',
        '14109': '横浜市港北区',
        '14110': '横浜市戸塚区',
        '14111': '横浜市港南区',
        '14112': '横浜市旭区',
        '14113': '横浜市緑区',
        '14114': '横浜市瀬谷区',
        '14115': '横浜市栄区',
        '14116': '横浜市泉区',
        '14117': '横浜市青葉区',
        '14118': '横浜市都筑区',
        '14130': '川崎市',
        '14131': '川崎市川崎区',
        '14132': '川崎市幸区',
        '14133': '川崎市中原区',
        '14134': '川崎市高津区',
        '14135': '川崎市多摩区',
        '14136': '川崎市宮前区',
        '14137': '川崎市麻生区',
        '14150': '相模原市',
        '14151': '相模原市緑区',
        '14152': '相模原市中央区',
        '14153': '相模原市南区',
        '14201': '横須賀市',
        '14203': '平塚市',
        '14204': '鎌倉市',
        '14205': '藤沢市',
        '14206': '小田原市',
        '14207': '茅ヶ崎市',
        '14208': '逗子市',
        '14210': '三浦市',
        '14211': '秦野市',
        '14212': '厚木市',
        '14213': '大和市',
        '14214': '伊勢原市',
        '14215': '海老名市',
        '14216': '座間市',
        '14217': '南足柄市',
        '14218': '綾瀬市',
    },
}


def get_prefecture_name(prefecture_code: str) -> str:
    """Get prefecture name from code
    
    Args:
        prefecture_code: Prefecture code (e.g., '02', '12', '13')
    
    Returns:
        Prefecture name in Japanese (e.g., '千葉県', '東京都')
        Returns 'その他' if code not found
    """
    # Remove leading zeros if present
    code = prefecture_code.lstrip('0') if prefecture_code else ''
    # Pad to 2 digits
    code = code.zfill(2)
    return PREFECTURE_MAP.get(code, 'その他')


def get_city_name(prefecture_code: str, city_code: str) -> str:
    """Get city name from prefecture and city codes
    
    Args:
        prefecture_code: Prefecture code (e.g., '02', '12', '13')
        city_code: City code (e.g., '12207', '13101')
    
    Returns:
        City name in Japanese (e.g., '松戸市', '千代田区')
        Returns 'その他' if code not found
    """
    # Remove leading zeros and pad
    pref_code = prefecture_code.lstrip('0').zfill(2) if prefecture_code else ''
    
    # Get city mapping for this prefecture
    cities = CITY_MAP.get(pref_code, {})
    return cities.get(city_code, 'その他')


def parse_url_location(url: str) -> tuple:
    """Parse location information from SumStock URL
    
    Args:
        url: SumStock URL (e.g., 'https://sumstock.jp/search/02/12/12207')
    
    Returns:
        Tuple of (prefecture_code, prefecture_name, city_code, city_name)
        Returns ('', 'その他', '', 'その他') if URL cannot be parsed
    """
    import re
    
    # Extract codes from URL pattern: /prefecture/??/city_code
    pattern = r'/search/(\d+)/(\d+)/(\d+)'
    match = re.search(pattern, url)
    
    if not match:
        return ('', 'その他', '', 'その他')
    
    prefecture_code = match.group(2)  # Middle number is prefecture
    city_code = match.group(3)  # Last number is city
    
    prefecture_name = get_prefecture_name(prefecture_code)
    city_name = get_city_name(prefecture_code, city_code)
    
    return (prefecture_code, prefecture_name, city_code, city_name)
